#!/usr/bin/env python3
"""
Sensor drivers launch file for {{ profile.name }}
Generated by ROS2 Build Tool
"""

from launch import LaunchDescription
from launch.actions import DeclareLaunchArgument
from launch.substitutions import LaunchConfiguration
from launch_ros.actions import Node{% if use_lifecycle %}, LifecycleNode{% endif %}
from launch_ros.substitutions import FindPackageShare


def generate_launch_description():
    """Launch all sensor drivers"""

    use_sim_time = LaunchConfiguration('use_sim_time', default='false')

    nodes = []

{% for component in hardware_components %}
{% if component.discovered_executable %}
    # {{ component.name }}
    {{ component.type }}_{{ component.name.lower().replace(' ', '_') }} = {{ 'LifecycleNode' if use_lifecycle else 'Node' }}(
        package='{{ component.package_name or component.name.lower().replace(" ", "_") }}',
        executable='{{ component.discovered_executable }}',
        name='{{ component.type }}_{{ component.name.lower().replace(" ", "_") }}',
        output='screen',
        parameters=[{'use_sim_time': use_sim_time}],
        respawn={{ 'False' if use_lifecycle else 'True' }},
{% if not use_lifecycle %}
        respawn_delay=2.0,
        respawn_max_count=5,
{% endif %}
    )
    nodes.append({{ component.type }}_{{ component.name.lower().replace(' ', '_') }})

{% endif %}
{% endfor %}

    return LaunchDescription(nodes)